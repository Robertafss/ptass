s._resizeEvent,t);rt(n,this._resizeClass)},unsubscribe:function(n,t){ut(n,this._resizeClass);n.removeEventListener(this._resizeEvent,t)},_handleResize:function(){for(var i,r=t.document.querySelectorAll("."+this._resizeClass),u=r.length,n=0;n<u;n++)i=t.document.createEvent("Event"),i.initEvent(this._resizeEvent,!1,!0),r[n].dispatchEvent(i)},_resizeClass:{get:function(){return"win-element-resize"}},_resizeEvent:{get:function(){return"WinJSElementResize"}}}),it=i.Class.define(function(n,t,i){i=i||{};this.registerThruWinJSCustomEvents=!!i.registerThruWinJSCustomEvents;this.objectName=n;this.object=t;this.capture={};this.bubble={}},{addEventListener:function(t,i,r,u){i=i.toLowerCase();var e=this._getHandlers(u),f=e[i];f||(f=this._getListener(i,u),f.refCount=0,e[i]=f,this.registerThruWinJSCustomEvents?n._addEventListener(this.object,i,f,u):this.object.addEventListener(i,f,u));f.refCount++;t.addEventListener(this._getEventName(i,u),r);rt(t,this._getClassName(i,u))},removeEventListener:function(t,i,r,u){i=i.toLowerCase();var e=this._getHandlers(u),f=e[i];f&&(f.refCount--,f.refCount===0&&(this.registerThruWinJSCustomEvents?n._removeEventListener(this.object,i,f,u):this.object.removeEventListener(i,f,u),delete e[i]));ut(t,this._getClassName(i,u));t.removeEventListener(this._getEventName(i,u),r)},_getHandlers:function(n){return n?this.capture:this.bubble},_getClassName:function(n,t){var i=t?"capture":"bubble";return"win-"+this.objectName.toLowerCase()+"-event-"+n+i},_getEventName:function(n,t){var i=t?"capture":"bubble";return"WinJS"+this.objectName+"Event-"+n+i},_getListener:function(n,i){var r=function(r){for(var u,s,o=t.document.querySelectorAll("."+this._getClassName(n,i)),h=o.length,f=!1,e=0;e<h;e++)u=t.document.createEvent("Event"),u.initEvent(this._getEventName(n,i),!1,!0),u.detail={originalEvent:r},s=o[e].dispatchEvent(u),f=f||!s;return f};return r.bind(this)}}),lt=!1,at=!1,ni=!1;var gi=t.navigator.msManipulationViewsEnabled||t.navigator.userAgent.indexOf("MSAppHost")>=0,nr=!!(t.MSPointerEvent||t.TouchEvent),tr=0;pt=".win-selectionborder, .win-
ClickHandler(t,i){i=i&&[...i,`HeaderFooterViewModel::getSubstrateUpsellClickHandler(authType=${t})`];let r=()=>{n.Host.refreshCurrentPane(),n.Host.setFocusInSearchBox(null,"SubstrateUpsell")};return()=>this._accessTokenManager.promptAutheticateDialog(t,n.getSubstrateResourceOrScope(t),r,r,i)}getSubstrateUpsell(t,i,r){let s=null,u="VerifyAccountToSearch",f=0,h="CloudSearch",c=["Verify"],e=null,o=[];if(r==0){let s=n.getEffectiveScope(this._currentQuery);f=6;let i=this._accessTokenManager?this._accessTokenManager.getCachedAccountInfo(t):null;i&&o.push(i.accountUserName);let r=[n.Scope.People,n.Scope.Emails,n.Scope.Documents];n.config.accountVerificationInAllScope&&r.push(n.Scope.All);n.contains(r,s)&&(o.length>0&&(u="VerifyAccount"),e=this._substrateUpsellDismiss);h=""}else r==2&&(u=null,f=2,s={content:"&#xE9BE",type:2,needsAccentColor:!0},e=this._substrateUpsellDismiss,c=["VerifyAccountToSearch"]);return this.createAdvancedOption(t==1?"COFA":"COOA",i,h,u,c,this.getSubstrateUpsellClickHandler(t,(n.Host===null||n.Host===void 0?void 0:n.Host.isAuthInvestigation())?[`HeaderFooterViewModel::getSubstrateUpsell(authType=${t}, position=${r})`]:undefined),f,e,s,null,o,"VerifyButton")}getOneDriveUpsell(t){return this.createAdvancedOption("SDSC",t,null,null,["SeeResultsFromOneDrive"],()=>{n.Host.launchCortanaSignIn()},2,null,{content:"&#xE9BE",type:2,needsAccentColor:!1})}getIndexingOption(t){let i=n.config.controlPanelSearchSettings?()=>n.Host.launchSearchSettings():()=>n.LocalDataProvider.launchIndexingOptions(!1);return this.createAdvancedOption("OMIO",t,"",null,["OptionsMenuIndexing"],i,2,null,{type:2,content:"&#xED52"})}getAdvancedOptionCssClass(n,t){return n==4?t?"menuInfo selectedAccount":"menuInfo":n==5?"menuLabel":null}createContextMenuGroup(n,t,i,r){let u=this.createAdvancedOption(n,t,null,i,null,null,5);return u.groupItems=r,u.narratorText=u.message,u}createBuildVersionOption(){const t=n.Host.getLocString("Build");return{id:"advancedOption"+this._advancedOptionsIdCounter++,selected:!1,title:t,message:undefined,text:t+": "+n.config.snrVersion,instItem:undefined,click:undefined,layout:4,cssClass:this.getAdvancedOptionCssClass(4),isSelectable:!1,subItems:undefined,isExpanded:!1}}createDebugFallbackOption(t){return this.createAdvancedOption(null,t,"FallbackBundleText",null,["FallbackBundleText"],()=>n.fallbackToPrepopulatedBundle(new Error("Fallback button clicked")),2,null,{type:2,content:"&#xE81F"})}createAdvancedOption(t,i,r,u,f,e,o,s,h,c,l,a){let y;t&&(y=this.getInstItem(t,i));let p="advancedOption"+this._advancedOptionsIdCounter++;c&&c.length==0&&(c=null);let v={id:p,selected:!1,title:n.Host.getLocString(r),message:u?n.Host.getLocString(u,...(l?l:[])):null,text:f?n.Host.getLocString(f[0]):null,instItem:y,click:undefined,layout:o,dismiss:s,icon:h,cssClass:this.getAdvancedOptionCssClass(o),isSelectable:!!e||!!c,subItems:c,buttonLabel:n.Host.getLocString(a),isExpanded:!c?undefined:!1};return v.narratorText=v.text,v.click=e?(t,i)=>{y&&n.InstrumentationHelper.instrumentItemClick(t,y,n.SequenceNumberManager.getSequenceNumber(),null,i,null),e(v)}:undefined,v}getAccountOptions(t,i){let u=[];if(!this._accessTokenManager)return u;let f=this._accessTokenManager.getCachedAccountInfo(0),e=this._accessTokenManager.getCachedAccountInfo(1),c=this._accessTokenManager.isMsaAvailable(),l=this._accessTokenManager.isAadAvailable(),o="menuItemWithButton focusable",s="removeHover",h="highlight",r;return(f||e)&&!i&&(r=this.createAdvancedOption(null,t,null,"ConnectedAccounts",null,null,5),r.cssClass=this.getAdvancedOptionCssClass(5),u.push(r),f&&n.isCloudSearchEnabledMsaCache&&(r=this.createAdvancedOption(null,t,null,null,["MicrosoftAccount"],null,4),r.message=f.accountUserName,r.narratorText=r.message,r.cssClass=this.getAdvancedOptionCssClass(4),n.isSubstrateOutlookAccountConnected||(r.cssClass+=" "+h),u.push(r),this._verifyAccountForMSARequired&&(r=this.createAdvancedOption(null,t,null,"VerifyAccountAttention",null,this.getSubstrateUpsellClickHandler(0,(n.Host===null||n.Host===void 0?void 0:n.Host.isAuthInvestigation())?[`HeaderFooterViewModel::getAccountOptions(VerifyAccountAttention|MSA)`]:undefined),4),r.cssClass=s,r.icon={type:2,content:"&#xE946"},u.push(r),r=this.createAdvancedOption("OMVA",t,null,"VerifyButton",null,this.getSubstrateUpsellClickHandler(0,(n.Host===null||n.Host===void 0?void 0:n.Host.isAuthInvestigation())?[`HeaderFooterViewModel::getAccountOptions(VerifyButton|MSA)`]:undefined),2),r.cssClass=o,u.push(r))),e&&n.isCloudSearchEnabledAadCache&&(r=this.createAdvancedOption(null,t,null,null,["AadAccount"],null,4),r.message=e.accountUserName,r.narratorText=r.message,r.cssClass=this.getAdvancedOptionCssClass(4),u.push(r),n.isSubstrateO365AccountConnected||(r.cssClass+=" "+h),this._verifyAccountForAADRequired&&(r=this.createAdvancedOption(null,t,null,"VerifyAccountAttention",null,this.getSubstrateUpsellClickHandler(1,(n.Host===null||n.Host===void 0?void 0:n.Host.isAuthInvestigation())?[`HeaderFooterViewModel::getAccountOptions(VerifyAccountAttention|AAD)`]:undefined),4),r.cssClass=s,r.icon={type:2,content:"&#xE946"},u.push(r),r=this.createAdvancedOption("OMVA",t,null,"VerifyButton",null,this.getSubstrateUpsellClickHandler(1,(n.Host===null||n.Host===void 0?void 0:n.Host.isAuthInvestigation())?[`HeaderFooterViewModel::getAccountOptions(VerifyButton|AAD)`]:undefined),2),r.cssClass=o,u.push(r))),u.push(this.getMenuDividerOption()),r=this.createAdvancedOption("OMAC",t,null,null,["ManageAccounts"],()=>n.Host.launchWindowsAccountSettings(),2,null,{type:2,content:"&#xE716"}),r.cssClass=this.getAdvancedOptionCssClass(2),u.push(r)),i&&this._accessTokenManager.getSelectedAccountInfo((n.Host===null||n.Host===void 0?void 0:n.Host.isAuthInvestigation())?["HeaderFooterViewModel::getAccountOptions"]:undefined)||(f&&(n.isCloudSearchEnabledM